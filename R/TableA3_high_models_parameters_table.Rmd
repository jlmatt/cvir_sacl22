```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(gt)
```

Read in model data

```{r}
data <-readRDS(file = here::here("data","derived","high_models_parameters")) %>%
  rename(Model = Modnames, k = K) %>%
  select(-ModelLik, -LL, -Cum.Wt, -Delta_AICc) %>%
  mutate(Model = c("m5", "m6","m1","m2","m3","m7","m4"))
```

Add in "variables" column after model column

```{r}
variables <- c("R + T",
"R + T + S",
"R + T + S + L",
"R + T + S + L + G",
"R + T + S + R x S",
"R + T + S + R x S + L",
"R + T + S + R x S + L + G") # this is in the order of m1,m2,m3...

# arrange so it is in the order of the data : m5,m6,m1,m2,m3,m7,m4

new_order <- c(5, 6, 1, 2, 3, 7, 4)
variables <- variables[new_order]
```

```{r}
data <- data %>%
  mutate(Variables = variables) %>%
  select(Model, Variables, everything()) %>%
  mutate(AICc = round(AICc,digits=2)) %>%
  mutate(AICcWt = round(AICcWt, digits = 3)) 
```

```{r}
gt_tbl <- gt(data)
t1 <- gt_tbl %>%
cols_align(
  align = "left",
  columns = everything()
) %>%
  opt_horizontal_padding(scale=3)

t1
```

Header: Table X: Parameters for coxme models (mi) corresponding to hypotheses about chance of survival.  k = number of parameters, including variance (Ïƒ2) as a parameter. AICc = corrected AIC value. AICcWt = model probability of fitting the observed data. 


```{r}
gtsave(t1, here::here("out","tbl","TableA3_high_models_parameters.png"))
```

